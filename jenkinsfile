node {
    def app
    def MSTEAMS_WEBHOOK = "https://tuigroup.webhook.office.com/webhookb2/dee846f6-dc11-45a3-b329-1855df85d23f@e3e1f65b-b973-440d-b61c-bc895fc98e28/IncomingWebhook/156b88146768481991cf30bb42a30aac/ed76e650-2edd-4741-b260-468a3e039897"
    withCredentials([string(credentialsId: 'devops-demo-webhook', variable: 'MSTEAMS_WEBHOOK')]) 
    {
        stage('Send start status') {
           sh "Succesfully initiated ${JOB_NAME} ${MSTEAMS_WEBHOOK}"
        }
        stage('Clone Repository') {
           git branch: "main", url: "https://github.com/waseemp/html-new.git"
        }
        stage('Docker Build') {
           sh "docker build -t 219004301212.dkr.ecr.us-east-1.amazonaws.com/helloworldjava:latest ."
        }
        stage('Push Image to ECR') {
        docker.withRegistry('https://219004301212.dkr.ecr.us-east-1.amazonaws.com', 'ecr:us-east-1:my.aws.credentials') {
           sh "docker push 219004301212.dkr.ecr.us-east-1.amazonaws.com/helloworldjava:latest"
        }
        }
    }
}

