node {
    def app
    def MSTEAMS_WEBHOOK
    withCredentials([string(credentialsId: 'devops-demo-webhook', variable: 'MSTEAMS_WEBHOOK')]) 
    {
        stage('Send start status') {
           sh "Succesfully initiated ${JOB_NAME} ${MSTEAMS_WEBHOOK}"
        }
        stage('Clone Repository') {
           git branch: "main", url: "https://github.com/waseemp/html-new.git"
        }
        stage('Docker Build') {
           sh "docker build -t 219004301212.dkr.ecr.us-east-1.amazonaws.com/helloworldjava:latest ."
        }
        stage('Push Image to ECR') {
        docker.withRegistry('https://219004301212.dkr.ecr.us-east-1.amazonaws.com', 'ecr:us-east-1:my.aws.credentials') {
           sh "docker push 219004301212.dkr.ecr.us-east-1.amazonaws.com/helloworldjava:latest"
        }
        }
    }
}

